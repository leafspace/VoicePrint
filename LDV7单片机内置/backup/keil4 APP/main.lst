C51 COMPILER V9.00   MAIN                                                                  05/22/2018 20:14:06 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\obj\main.obj
COMPILER INVOKED BY: C:\NSProgram\Keil\C51\BIN\C51.EXE ..\code\main.c BROWSE INCDIR(..\code;..\user) DEBUG OBJECTEXTEND
                    - PRINT(.\main.lst) OBJECT(..\obj\main.obj)

line level    source

   1          /***************************é£éŸ³äº‘ç”µå­****************************
   2          **  å·¥ç¨‹åç§°ï¼šYS-V0.7è¯­éŸ³è¯†åˆ«æ¨¡å—é©±åŠ¨ç¨‹åº
   3          **      CPU: STC11L08XE
   4          **      æ™¶æŒ¯ï¼š22.1184MHZ
   5          **      æ³¢ç‰¹ç‡ï¼š9600 bit/S
   6          **      é…å¥—äº§å“ä¿¡æ¯ï¼šYS-V0.7è¯­éŸ³è¯†åˆ«å¼€å‘æ¿
   7          **                http://yuesheng001.taobao.com
   8          **  ä½œè€…ï¼šzdings
   9          **  è”ç³»ï¼š751956552@qq.com
  10          **  ä¿®æ”¹æ—¥æœŸï¼š2013.9.13
  11          **  è¯´æ˜ï¼šå£ä»¤æ¨¡å¼+IOæ§åˆ¶ï¼š å³æ¯æ¬¡è¯†åˆ«æ—¶éƒ½éœ€è¦è¯´"å°æ°"è¿™ä¸ªå£ä»¤ ï¼Œæ‰èƒ½å¤Ÿè¿›è¡
             -Œä¸‹ä¸€çº§çš„è¯†åˆ«
  12          /***************************é£éŸ³äº‘ç”µå­******************************/
  13          #include "config.h"
  14          /************************************************************************************/
  15          //      nAsrStatus ç”¨æ¥åœ¨mainä¸»ç¨‹åºä¸­è¡¨ç¤ºç¨‹åºè¿è¡Œçš„çŠ¶æ€ï¼Œä¸æ˜¯LD3320èŠ¯ç‰‡å†…éƒ¨çš„çŠ¶æ€å¯„å
             -­˜å™¨
  16          //      LD_ASR_NONE:            è¡¨ç¤ºæ²¡æœ‰åœ¨ä½œASRè¯†åˆ«
  17          //      LD_ASR_RUNINGï¼š                è¡¨ç¤ºLD3320æ­£åœ¨ä½œASRè¯†åˆ«ä¸­
  18          //      LD_ASR_FOUNDOK:         è¡¨ç¤ºä¸€æ¬¡è¯†åˆ«æµç¨‹ç»“æŸåï¼Œæœ‰ä¸€ä¸ªè¯†åˆ«ç»“æœ
  19          //      LD_ASR_FOUNDZERO:       è¡¨ç¤ºä¸€æ¬¡è¯†åˆ«æµç¨‹ç»“æŸåï¼Œæ²¡æœ‰è¯†åˆ«ç»“æœ
  20          //      LD_ASR_ERROR:           è¡¨ç¤ºä¸€æ¬¡è¯†åˆ«æµç¨‹ä¸­LD3320èŠ¯ç‰‡å†…éƒ¨å‡ºç°ä¸æ­£ç¡®çš„çŠ¶æ€
  21          /***********************************************************************************/
  22          uint8 idata nAsrStatus = 0;
  23          void MCU_init();
  24          void ProcessInt0();                                                         // è¯†åˆ«å¤„ç†å‡½æ•°
  25          void delay(unsigned long uldata);
  26          void User_handle(uint8 dat);                                                // ç”¨æˆ·æ‰§è¡Œæ“ä½œå‡½æ•°
  27          void Led_test(void);                                                        // å•ç‰‡æœºå·¥ä½œæŒ‡ç¤º
  28          void Delay200ms();
  29          uint8_t G0_flag = DISABLE;                                                  // è¿è¡Œæ ‡å¿—ï¼ŒENABLE:è¿è¡
             -Œã€‚DISABLE:ç¦æ­¢è¿è¡Œ 
  30          sbit LED = P4 ^ 2;                                                          // ä¿¡å·æŒ‡ç¤ºç¯
  31          //åº”ç”¨IOå£å®šä¹‰ ï¼ˆæ¨¡å—æ ‡æ³¨ P2ï¼‰
  32          sbit PA1 = P1 ^ 0;                                                          // å¯¹åº”æ¿ä¸Šæ ‡å· P1.0
  33          sbit PA2 = P1 ^ 1;                                                          // å¯¹åº”æ¿ä¸Šæ ‡å· P1.1
  34          sbit PA3 = P1 ^ 2;                                                          // .....
  35          sbit PA4 = P1 ^ 3;                                                          // .....
  36          sbit PA5 = P1 ^ 4;                                                          // .....
  37          sbit PA6 = P1 ^ 5;                                                          // .....
  38          sbit PA7 = P1 ^ 6;                                                          // å¯¹åº”æ¿ä¸Šæ ‡å· P1.6
  39          sbit PA8 = P1 ^ 7;                                                          // å¯¹åº”æ¿ä¸Šæ ‡å· P1.7
  40          
  41          
  42          /***********************************************************
  43          * å    ç§°ï¼š void  main(void)
  44          * åŠŸ    èƒ½ï¼š ä¸»å‡½æ•°       ç¨‹åºå…¥å£
  45          * å…¥å£å‚æ•°ï¼š
  46          * å‡ºå£å‚æ•°ï¼š
  47          * è¯´    æ˜ï¼š
  48          * è°ƒç”¨æ–¹æ³•ï¼š
  49          **********************************************************/
  50          void  main(void)
  51          {
C51 COMPILER V9.00   MAIN                                                                  05/22/2018 20:14:06 PAGE 2   

  52   1              uint8 idata nAsrRes;
  53   1              uint8 i = 0;
  54   1              Led_test();
  55   1              MCU_init();
  56   1              LD_Reset();
  57   1              UartIni();                                                               /* ä¸²å£åˆå§‹åŒ– */
  58   1              nAsrStatus = LD_ASR_NONE;                                                // åˆå§‹çŠ¶æ€ï¼šæ²¡æœ‰åœ¨ä½œAS
             -R
  59   1      
  60   1              PrintCom("First level password : xiaojie \r\n");
  61   1              PrintCom("Secondary password   : \r\n");
  62   1              PrintCom("      1. Test \r\n");
  63   1              PrintCom("      2. kaifabanyanzhen \r\n");
  64   1              PrintCom("      3. kaideng \r\n");
  65   1              PrintCom("      4. guandeng \r\n");
  66   1              PrintCom("      5. beijing \r\n");
  67   1              PrintCom("      6. shanghai \r\n");
  68   1              PrintCom("      7. guangzhou \r\n");
  69   1      
  70   1              while (1)
  71   1              {
  72   2                      switch (nAsrStatus)
  73   2                      {
  74   3                      case LD_ASR_RUNING:
  75   3                      case LD_ASR_ERROR:
  76   3                              break;
  77   3                      case LD_ASR_NONE:
  78   3                      {
  79   4                              nAsrStatus = LD_ASR_RUNING;
  80   4                              if (RunASR() == 0)                                              /* å¯åŠ¨ä¸€æ¬¡ASRè¯†åˆ«æµç¨‹ï¼šASRåˆ
             -å§‹åŒ–ï¼ŒASRæ·»åŠ å…³é”®è¯è¯­ï¼Œå¯åŠ¨ASRè¿ç®— */
  81   4                              {
  82   5                                      nAsrStatus = LD_ASR_ERROR;
  83   5                              }
  84   4                              break;
  85   4                      }
  86   3                      case LD_ASR_FOUNDOK:                                                /* ä¸€æ¬¡ASRè¯†åˆ«æµç¨‹ç»“æŸï¼Œå»
             -å–ASRè¯†åˆ«ç»“æœ */
  87   3                      {
  88   4                              nAsrRes = LD_GetResult();                                       /* è·å–ç»“æœ */
  89   4                              User_handle(nAsrRes);                                           // ç”¨æˆ·æ‰§è¡Œå‡½æ•° 
  90   4                              nAsrStatus = LD_ASR_NONE;
  91   4                              break;
  92   4                      }
  93   3                      case LD_ASR_FOUNDZERO:
  94   3                      default:
  95   3                      {
  96   4                              nAsrStatus = LD_ASR_NONE;
  97   4                              break;
  98   4                      }
  99   3                      }
 100   2              }
 101   1      
 102   1      }
 103          /***********************************************************
 104          * å    ç§°ï¼š          LEDç¯æµ‹è¯•
 105          * åŠŸ    èƒ½ï¼š å•ç‰‡æœºæ˜¯å¦å·¥ä½œæŒ‡ç¤º
 106          * å…¥å£å‚æ•°ï¼š æ— 
 107          * å‡ºå£å‚æ•°ï¼šæ— 
 108          * è¯´    æ˜ï¼š
 109          **********************************************************/
 110          void Led_test(void)
C51 COMPILER V9.00   MAIN                                                                  05/22/2018 20:14:06 PAGE 3   

 111          {
 112   1              LED = ~LED;
 113   1              Delay200ms();
 114   1              LED = ~LED;
 115   1              Delay200ms();
 116   1              LED = ~LED;
 117   1              Delay200ms();
 118   1              LED = ~LED;
 119   1              Delay200ms();
 120   1              LED = ~LED;
 121   1              Delay200ms();
 122   1              LED = ~LED;
 123   1      }
 124          /***********************************************************
 125          * å    ç§°ï¼š void MCU_init()
 126          * åŠŸ    èƒ½ï¼š å•ç‰‡æœºåˆå§‹åŒ–
 127          * å…¥å£å‚æ•°ï¼š
 128          * å‡ºå£å‚æ•°ï¼š
 129          * è¯´    æ˜ï¼š
 130          * è°ƒç”¨æ–¹æ³•ï¼š
 131          **********************************************************/
 132          void MCU_init()
 133          {
 134   1              P0 = 0xff;
 135   1              P1 = 0x00;
 136   1              P2 = 0xff;
 137   1              P3 = 0xff;
 138   1              P4 = 0xff;
 139   1      
 140   1              P1M0 = 0XFF;                                                            // P1ç«¯å£è®¾ç½®ä¸ºæ¨æŒ½è¾“å‡ºåŠŸè
             -ƒ½ï¼Œå³æé«˜IOå£é©±åŠ¨èƒ½åŠ›ï¼Œä»é©±åŠ¨ç»§ç”µå™¨æ¨¡å—å·¥ä½œ
 141   1              P1M1 = 0X00;
 142   1      
 143   1              LD_MODE = 0;                                                                // è®¾ç½®MDç®¡è„šä¸ºä½ï¼Œå¹¶è¡Œæ¨¡å¼è
             -¯»å†™
 144   1              IE0 = 1;
 145   1              EX0 = 1;
 146   1              EA = 1;
 147   1      }
 148          /***********************************************************
 149          * å    ç§°ï¼š å»¶æ—¶å‡½æ•°
 150          * åŠŸ    èƒ½ï¼š
 151          * å…¥å£å‚æ•°ï¼š
 152          * å‡ºå£å‚æ•°ï¼š
 153          * è¯´    æ˜ï¼š
 154          * è°ƒç”¨æ–¹æ³•ï¼š
 155          **********************************************************/
 156          void Delay200us()                                                                   // @22.1184MHz
 157          {
 158   1              unsigned char i, j;
 159   1              _nop_();
 160   1              _nop_();
 161   1              i = 5;
 162   1              j = 73;
 163   1              do
 164   1              {
 165   2                      while (--j);
 166   2              } while (--i);
 167   1      }
 168          
 169          void  delay(unsigned long uldata)
 170          {
C51 COMPILER V9.00   MAIN                                                                  05/22/2018 20:14:06 PAGE 4   

 171   1              unsigned int j = 0;
 172   1              unsigned int g = 0;
 173   1              while (uldata--)
 174   1                      Delay200us();
 175   1      }
 176          
 177          void Delay200ms()                                                                       // @22.1184MHz
 178          {
 179   1              unsigned char i, j, k;
 180   1      
 181   1              i = 17;
 182   1              j = 208;
 183   1              k = 27;
 184   1              do
 185   1              {
 186   2                      do
 187   2                      {
 188   3                              while (--k);
 189   3                      } while (--j);
 190   2              } while (--i);
 191   1      }
 192          
 193          /***********************************************************
 194          * å    ç§°ï¼š ä¸­æ–­å¤„ç†å‡½æ•°
 195          * åŠŸ    èƒ½ï¼š
 196          * å…¥å£å‚æ•°ï¼š
 197          * å‡ºå£å‚æ•°ï¼š
 198          * è¯´    æ˜ï¼š
 199          * è°ƒç”¨æ–¹æ³•ï¼š
 200          **********************************************************/
 201          void ExtInt0Handler(void) interrupt 0
 202          {
 203   1              ProcessInt0();                                                                      /* LD3320 é€å‡ºä¸­æ–­ä¿¡å·ï¼ŒåŒ…æ‹¬ASRå’Œ
             -æ’­æ”¾MP3çš„ä¸­æ–­ï¼Œéœ€è¦åœ¨ä¸­æ–­å¤„ç†å‡½æ•°ä¸­åˆ†åˆ«å¤„ç† */
 204   1      }
 205          /***********************************************************
 206          * å    ç§°ï¼šç”¨æˆ·æ‰§è¡Œå‡½æ•°
 207          * åŠŸ    èƒ½ï¼šè¯†åˆ«æˆåŠŸåï¼Œæ‰§è¡ŒåŠ¨ä½œå¯åœ¨æ­¤è¿›è¡Œä¿®æ”¹
 208          * å…¥å£å‚æ•°ï¼š æ— 
 209          * å‡ºå£å‚æ•°ï¼šæ— 
 210          * è¯´    æ˜ï¼š é€šè¿‡æ§åˆ¶PAxç«¯å£çš„é«˜ä½ç”µå¹³ï¼Œä»è€Œæ§åˆ¶å¤–éƒ¨ç»§ç”µå™¨çš„é€šæ–­
 211          **********************************************************/
 212          void    User_handle(uint8 dat)
 213          {
 214   1              // UARTSendByte(dat);                                                   // ä¸²å£è¯†åˆ«ç ï¼ˆåå…­è¿›åˆ¶
             -ï¼‰
 215   1              if (0 == dat)
 216   1              {
 217   2                      G0_flag = ENABLE;
 218   2                      LED = 0;
 219   2              }
 220   1              else if (ENABLE == G0_flag)
 221   1              {
 222   2                      G0_flag = DISABLE;
 223   2                      LED = 1;
 224   2                      switch (dat)
 225   2                      {
 226   3                      case CODE_DMCS:
 227   3                              PrintCom("<Test> Command recognition succeeded \r\n");
 228   3                              PA1 = 1;                                                        // è®©PA1ç«¯å£ä¸ºé«˜ç”µå¹³
 229   3                              break;
 230   3                      case CODE_KFBYZ:
C51 COMPILER V9.00   MAIN                                                                  05/22/2018 20:14:06 PAGE 5   

 231   3                              PrintCom("<kaifabanyanzhen> Command recognition succeeded \r\n");
 232   3                              PA2 = 1;
 233   3                              break;
 234   3                      case CODE_KD:
 235   3                              PrintCom("<kaideng> Command recognition succeeded \r\n");
 236   3                              PA3 = 1;
 237   3                              break;
 238   3                      case CODE_GD:
 239   3                              PrintCom("<guandeng> Command recognition succeeded \r\n");
 240   3                              PA3 = 0;
 241   3                              break;
 242   3                      case CODE_BJ:
 243   3                              PrintCom("<beijing> Command recognition succeeded \r\n");
 244   3                              PA4 = 1;
 245   3                              break;
 246   3                      case CODE_SH:
 247   3                              PrintCom("<shanghai> Command recognition succeeded \r\n");
 248   3                              PA5 = 1;
 249   3                              break;
 250   3                      case CODE_GZ:
 251   3                              PrintCom("<guangzhou> Command recognition succeeded \r\n");
 252   3                              PA6 = 1;
 253   3                              break;
 254   3                      default:
 255   3                              PrintCom("Please re-identify the password ! \r\n");
 256   3                              break;
 257   3                      }
 258   2              }
 259   1              else
 260   1              {
 261   2                      PrintCom("Please speak out a password ! \r\n");
 262   2              }
 263   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    480    ----
   CONSTANT SIZE    =    554    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       9
   IDATA SIZE       =      1       1
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
